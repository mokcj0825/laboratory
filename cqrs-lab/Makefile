# CQRS Lab Makefile

.PHONY: help setup start stop clean dev build test-api logs db-push db-studio-command db-studio-query sync-full

help:
	@echo "CQRS Lab - Available Commands"
	@echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
	@echo "  make setup            - åˆå§‹åŒ–é¡¹ç›®ï¼ˆå®‰è£…ä¾èµ–ã€å¯åŠ¨æ•°æ®åº“ã€æ¨é€ Schemaï¼‰"
	@echo "  make start            - å¯åŠ¨æ•°æ®åº“å®¹å™¨"
	@echo "  make stop             - åœæ­¢æ•°æ®åº“å®¹å™¨"
	@echo "  make clean            - æ¸…ç†æ•°æ®åº“å’Œå®¹å™¨"
	@echo "  make dev              - å¯åŠ¨å¼€å‘æœåŠ¡å™¨"
	@echo "  make build            - æ„å»ºç”Ÿäº§ç‰ˆæœ¬"
	@echo "  make test-api         - è¿è¡Œ API æµ‹è¯•"
	@echo "  make logs             - æŸ¥çœ‹å®¹å™¨æ—¥å¿—"
	@echo "  make db-push          - æ¨é€æ•°æ®åº“ Schema"
	@echo "  make db-studio-command - æ‰“å¼€ Command DB ç®¡ç†ç•Œé¢"
	@echo "  make db-studio-query   - æ‰“å¼€ Query DB ç®¡ç†ç•Œé¢"
	@echo "  make sync-full        - æ‰§è¡Œå…¨é‡æ•°æ®åŒæ­¥"
	@echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"

setup:
	@chmod +x scripts/setup.sh
	@./scripts/setup.sh

start:
	@echo "ğŸ˜ Starting databases..."
	@docker-compose up -d
	@echo "âœ“ Databases started"

stop:
	@echo "ğŸ›‘ Stopping databases..."
	@docker-compose stop
	@echo "âœ“ Databases stopped"

clean:
	@echo "ğŸ§¹ Cleaning up..."
	@docker-compose down -v
	@echo "âœ“ Cleaned up"

dev:
	@echo "ğŸš€ Starting development server..."
	@npm run dev

build:
	@echo "ğŸ”¨ Building..."
	@npm run build

test-api:
	@chmod +x scripts/test-api.sh
	@./scripts/test-api.sh

logs:
	@docker-compose logs -f

db-push:
	@echo "ğŸ“Š Pushing database schemas..."
	@npm run prisma:push

db-studio-command:
	@echo "ğŸ¨ Opening Command DB Studio..."
	@npm run prisma:studio:command

db-studio-query:
	@echo "ğŸ¨ Opening Query DB Studio..."
	@npm run prisma:studio:query

sync-full:
	@echo "ğŸ”„ Triggering full sync..."
	@curl -X POST http://localhost:3000/api/sync/full

